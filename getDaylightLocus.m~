% created by ACH 09/04/2020
% script to get the daylight locus

[T_cies026, S_cies026] = GetCIES026;
wlsCIES026 = (390:1:780)';
% rescale only over range where we have cone fundmanetals i.e. 390nm:780nm
T_cies026 = T_cies026(:,11:5:end);
% remove Nans
T_cies026(isnan(T_cies026)) = 0;

activations = T_cies026;

function daylightLocus = getDaylightLocus(activations)

% simulate daylight locus
daylightSPD = csvread('daylightSpectra.csv');
wlsSpd = daylightSPD(3:end,1);
% cols are different illuminants, rows are diff wavelengths
daylightSPD = daylightSPD(3:end,2:end);

% normalise daylight locus
normSpd = normIllSpd(daylightSPD, wlsSpd)

% calculate daylight locus in L,M,S,R,I coordinate space
for m=1:size(daylightSPD,2)
    for k=1:size(activations,1)
        daylightLocus(m,k)=activations(k,:)*(daylightSPD(:,m));
    end
end
% remove Nans
daylightLocus(isnan(daylightLocus))=0;

end